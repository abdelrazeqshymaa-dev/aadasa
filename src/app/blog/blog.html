<div class="blog-page min-vh-100">
    <div class="blog-hero position-relative py-5 overflow-hidden">
        <div class="position-absolute top-0 start-0 w-100 h-100 blog-bg"></div>
        <div class="blog-grid-bg position-absolute top-0 start-0 w-100 h-100"></div>
        
        <div class="position-absolute top-0 start-0 w-100 h-100">
            <div class="blog-blob-1 position-absolute"></div>
            <div class="blog-blob-2 position-absolute"></div>
        </div>
        
        <div class="container position-relative text-center">
           <div class="section-label rounded-5 d-inline-flex align-items-center gap-2 mb-4">
                            <span class="ping-wrapper ping-wrapper-sm position-relative d-flex">
                                <span class="ping-dot position-absolute"></span>
                                <span class="static-dot position-relative d-inline-flex rounded-circle"></span>
                            </span>
                            <span class="ping-wrapper ping-wrapper-delayed position-relative d-flex">
                                <span class="ping-dot position-absolute"></span>
                                <span class="static-dot position-relative d-inline-flex rounded-circle"></span>
                            </span>
                            <span class="label-text small fw-medium">مدونتنا</span>
                        </div>
            <h1 class="display-4 fw-bold text-white mb-4">
                استكشف <span class="text-orange">مقالاتنا</span>
            </h1>
            <p class="fs-5 text-secondary mx-auto blog-subtitle">
                اكتشف الدروس والرؤى وأفضل الممارسات للتطوير الحديث
            </p>
        </div>
    </div>

    <div class="blog-filter-sticky sticky-top bg-dark-blur border-bottom">
        <div class="container py-3">
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center gap-3">
                <div class="position-relative w-100 blog-search-width">
                    <input type="text" 
                           [(ngModel)]="searchTerm"
                           class="blog-search-input form-control px-5 py-3" 
                           placeholder="ابحث في المقالات...">
                    <svg class="blog-search-icon position-absolute" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                
                <div class="d-flex flex-wrap justify-content-center gap-2">
                    <button (click)="filterByCategory('الكل')" [class.blog-filter-active]="selectedCategory === 'الكل'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">
                        جميع المقالات
                    </button>
                    <button (click)="filterByCategory('إضاءة')" [class.blog-filter-active]="selectedCategory === 'إضاءة'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">إضاءة</button>
                    <button (click)="filterByCategory('بورتريه')" [class.blog-filter-active]="selectedCategory === 'بورتريه'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">بورتريه</button>
                    <button (click)="filterByCategory('مناظر طبيعية')" [class.blog-filter-active]="selectedCategory === 'مناظر طبيعية'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">مناظر طبيعية</button>
                    <button (click)="filterByCategory('تقنيات')" [class.blog-filter-active]="selectedCategory === 'تقنيات'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">تقنيات</button>
                    <button (click)="filterByCategory('معدات')" [class.blog-filter-active]="selectedCategory === 'معدات'" class="btn blog-filter-btn px-4 py-2 rounded-3 small fw-medium">معدات</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container py-5">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <p class="text-secondary mb-0">
                عرض <span class="fw-bold text-white">{{ filteredCount() }}</span> مقالات @if (selectedCategory !== 'الكل') {<span> في <span class="text-orange fw-bold">{{ selectedCategory }}</span></span>}
            </p>
            <div class="d-flex align-items-center gap-2">
                <div class="blog-view-toggle d-flex align-items-center p-1 rounded-3">
                    <button (click)="toggleView('grid')" [class.active]="viewMode === 'grid'" class="blog-view-btn p-2 rounded-2" title="عرض شبكي">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                        </svg>
                    </button>
                    <button (click)="toggleView('list')" [class.active]="viewMode === 'list'" class="blog-view-btn p-2 rounded-2" title="عرض قائمة">
                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        @if (viewMode === 'grid') {
        <div class="row g-4">
           @for (post of postpages(); track $index) {
             <div class="col-md-6 col-lg-4">
                <article class="blog-article-card rounded-4 overflow-hidden">
                    <div class="d-block">
                        <div class="blog-article-image-wrapper position-relative overflow-hidden">
                            <img [src]="post.image" 
                                 [alt]="post.title" 
                                 class="blog-article-image w-100 h-100">
                            <div class="blog-article-overlay position-absolute top-0 start-0 w-100 h-100"></div>
                            <div class="position-absolute top-0 end-0 m-3">
                                <span class="blog-category-badge px-3 py-1 rounded-pill small fw-semibold text-white">{{ post.category }}</span>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="d-flex align-items-center gap-3 mb-3 small text-secondary">
                                <span class="d-flex align-items-center gap-1">
                                    <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    {{ post.readTime }}
                                </span>
                                <span class="blog-dot rounded-circle"></span>
                                <span>{{ post.date }}</span>
                            </div>
                            <h3 class="blog-article-title fs-5 fw-bold text-white mb-3">{{ post.title }}</h3>
                            <p class="blog-article-excerpt text-secondary mb-4 small">{{ post.excerpt }}</p>
                            <div class="d-flex align-items-center justify-content-between pt-3 border-top">
                                <div class="d-flex align-items-center gap-3">
                                    <img [src]="post.author.avatar" 
                                         [alt]="post.author.name" 
                                         class="blog-author-avatar rounded-circle">
                                    <div>
                                        <p class="small fw-medium text-white mb-0">{{ post.author.name }}</p>
                                        <p class="blog-author-role mb-0">{{ post.author.role }}</p>
                                    </div>
                                </div>
                                <div class="blog-icon-wrapper rounded-circle d-flex align-items-center justify-content-center">
                                    <svg class="blog-icon-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
           }
        </div>
        }

        @if (viewMode === 'list') {
        <div class="d-flex flex-column gap-4">
           @for (post of postpages(); track $index) {
            <article class="blog-list-card rounded-4 overflow-hidden border">
                <div class="d-block">
                    <div class="row g-0">
                        <div class="col-md-5 col-lg-4">
                            <div class="blog-list-image-wrapper position-relative overflow-hidden h-100">
                                <img [src]="post.image" 
                                     [alt]="post.title" 
                                     class="blog-list-image w-100 h-100">
                                <div class="blog-article-overlay position-absolute top-0 start-0 w-100 h-100"></div>
                            </div>
                        </div>
                        <div class="col-md-7 col-lg-8">
                            <div class="p-4 p-lg-5 d-flex flex-column justify-content-center h-100">
                                <div class="d-flex flex-wrap align-items-center gap-3 mb-3">
                                    <span class="blog-category-badge px-3 py-1 rounded-pill small fw-semibold text-white">{{ post.category }}</span>
                                    <span class="d-flex align-items-center gap-1 small text-secondary">
                                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        {{ post.readTime }}
                                    </span>
                                    <span class="d-flex align-items-center gap-1 small text-secondary">
                                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                        </svg>
                                        {{ post.date }}
                                    </span>
                                </div>
                                <h2 class="blog-list-title fs-4 fw-bold text-white mb-3">{{ post.title }}</h2>
                                <p class="blog-list-excerpt text-secondary mb-4 lh-relaxed">{{ post.excerpt }}</p>
                                <div class="d-flex align-items-center justify-content-between mt-auto">
                                    <div class="d-flex align-items-center gap-3">
                                        <img [src]="post.author.avatar" 
                                             [alt]="post.author.name" 
                                             class="blog-list-author-avatar rounded-circle">
                                        <div>
                                            <p class="small fw-semibold text-white mb-0">{{ post.author.name }}</p>
                                            <p class="blog-author-role mb-0">{{ post.author.role }}</p>
                                        </div>
                                    </div>
                                    <span class="d-none d-sm-inline-flex align-items-center gap-2 text-white fw-semibold small blog-read-more">
                                        اقرأ المقال
                                        <svg class="blog-arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="transform: rotate(180deg);">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                        </svg>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
           }
        </div>
        }

        @if (totalPages() > 1) {
        <div class="d-flex justify-content-center align-items-center gap-2 mt-5">
            <button (click)="previousPage()" [disabled]="currentPage === 1" class="btn blog-pagination-btn p-3 rounded-3" [class.blog-pagination-enabled]="currentPage > 1">
                <svg class="icon-sm blog-arrow-rotate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
            
            <div class="d-flex align-items-center gap-1">
                @for (pageNum of getPageNumbers(); track pageNum) {
                  <button (click)="goToPage(pageNum)" [class.blog-page-active]="currentPage === pageNum" class="btn blog-page-btn">{{ pageNum }}</button>
                }
            </div>
            
            <button (click)="nextPage()" [disabled]="currentPage === totalPages()" class="btn blog-pagination-btn p-3 rounded-3" [class.blog-pagination-enabled]="currentPage < totalPages()">
                <svg class="icon-sm blog-arrow-rotate" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
        </div>
        
        <p class="text-center text-secondary mt-3 small">صفحة {{ currentPage }} من {{ totalPages() }}</p>
        }
    </div>
</div>